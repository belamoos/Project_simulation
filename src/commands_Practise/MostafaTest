This is the first change from Mostafa branch